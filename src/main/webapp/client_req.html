
<!DOCTYPE html>
<html class="no-js">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Nearest</title>


<!-- CSS Files -->

<!-- Animate.css -->
<link rel="stylesheet" href="./resources/css/animate.css">
<!-- Icomoon Icon Fonts-->
<link rel="stylesheet" href="./resources/css/icomoon.css">
<!-- Simple Line Icons -->
<link rel="stylesheet" href="./resources/css/simple-line-icons.css">
<!-- Magnific Popup -->
<link rel="stylesheet" href="./resources/css/magnific-popup.css">
<!-- Bootstrap  -->
<link rel="stylesheet" href="./resources/css/bootstrap.css">
<!-- Signup CSS -->
<link rel="stylesheet"
	href="http://fonts.googleapis.com/css?family=Roboto:400,100,300,500">
<link rel="stylesheet"
	href="./resources/css/font-awesome/css/font-awesome.min.css">
<!-- <link rel="stylesheet" href="./resources/css/form-elements.css"> -->
<link rel="stylesheet" href="./resources/css/main_signup.css">
<link rel="stylesheet" href="./resources/css/style.css">
<link rel="stylesheet" href="./resources/css/main_top_menu.css">
<link rel="stylesheet" href="./resources/css/main_login.css">
<!-- BootStrap DateTimePicker -->
<link rel="stylesheet"
	href="//cdn.rawgit.com/Eonasdan/bootstrap-datetimepicker/e8bddc60e73c1ec2475f827be36e1957af72e2ea/build/css/bootstrap-datetimepicker.css">
<!-- DropDown Menu -->
<link rel="stylesheet" href="./resources/css/main_dropdown.css">
<!-- Client Payment PopUp -->
<link rel="stylesheet" href="./resources/css/client_payment.css">
<link rel="stylesheet" href="./resources/css/client_menu.css">
<link rel="stylesheet" href="./resources/css/client_main.css">


<!-- JS Files -->

<!-- jQuery -->
<script src="./node_modules/jquery/dist/jquery.min.js"></script>
<!-- jQuery Easing -->
<script
	src="./node_modules/jquery-easing/dist/jquery.easing.1.3.umd.min.js"></script>
<!-- Bootstrap -->
<script src="./node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="./node_modules/jquery-waypoints/waypoints.min.js"></script>
<!-- Stellar Parallax -->
<script src="./resources/js/jquery.stellar.min.js"></script>
<!-- Counter -->
<script src="./node_modules/jquery-countto/jquery.countTo.js"></script>
<!-- Magnific Popup -->
<script
	src="./node_modules/magnific-popup/dist/jquery.magnific-popup.min.js"></script>
<script src="./resources/js/magnific-popup-options.js"></script>
<!-- Handlebars -->
<script src="./node_modules/handlebars/dist/handlebars.min.js"></script>

<script src="./resources/js/jquery.backstretch.min.js"></script>
<script src="./resources/js/scripts.js"></script>
<script
	src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.js"></script>
<script src="./resources/js/bootstrap-datetimepicker.js"></script>
<!-- Modernizr JS -->
<script src="./node_modules/npm-modernizr/modernizr.js"></script>
<!-- FOR IE9 below -->
<!--[if lt IE 9]>
  <script src="./js/respond.min.js"></script>
  <![endif]-->

<!-- jQuery Cookie -->
<script src="./node_modules/jquery.cookie/jquery.cookie.js"></script>
<!-- IamPort 결제 -->
<script type="text/javascript" src="https://service.iamport.kr/js/iamport.payment-1.1.1.js"></script>

<style>
#fh5co-header {
  position: inherit !important;
}

.nearest-header-menu {
  position: inherit !important;
} 


#product-detail-form {
   background-color: white !important;
}

#loginAfter {
  display: none;
}

#nearest-dropdown {
  display: none;
}
</style>
</head>

<body>
  <header role="banner" id="fh5co-header">
    <div class="container nearest-header-menu">
        <div class="row box-shadow nearest-header-top-menu">
        
          <div id="nearest-dropdown" class="nearest-dropdown nearest-header-menu-btn"> 
            <span class="glyphicon glyphicon-align-justify nearest-drop-span" 
                  aria-hidden="true"
                  onclick="myFunction()">
            </span>
            
            <div id="myDropdown" class="nearest-dropdown-content">
              <a href="./client.html">찜 목록</a>
              <a href="./client.html">구매 목록</a>
              <a href="./client.html">건의 사항</a>
            </div>
          </div>
        
          <div class="white-popup nearest-header-menu-btn" id="loginAfter">
            <a id="myInfoBtn">
              <strong>내정보</strong>
            </a>
            <strong>|</strong>
            <a id="logoutBtn">
              <strong>로그아웃</strong>
            </a> 
          </div>
          
          <a id="signupBtn" href="#signupForm" class="white-popup popup-modal nearest-header-menu-btn">
            <strong>REGISTER</strong>
          </a>
          
          <a id="btnSplit" class="nearest-header-menu-btn">
            <strong>|</strong>
          </a>
          
          <a id="loginBtn" href="#loginForm" class="white-popup popup-modal nearest-header-menu-btn">
            <strong>LOGIN</strong>
          </a>
          
          
        
        </div>
      
        <div class="row box-shadow nearest-header-logo">
          <div>
          
            <img src="./resources/images/logo_2.png"/>
            
          </div> <!-- .nearest-header-nav end -->
        </div>
        
        <div class="row box-shadow top-nav">
          <div class="nearest-header-nav">
            <div class="col-xs-2">
              <select name="searchTag" class="form-control">
                <option value="prods">제품검색</option>
                <option value="marts">매장검색</option>
              </select>
            </div>
            
            <div class="col-xs-4">
              <div class="input-group">
                <input type="text"
                       name="searchContent" 
                       class="form-control" 
                       placeholder="상품을 입력하세요.">
                <span class="input-group-btn">
                  <button id="nearest-search" 
                          class="btn btn-default" 
                          type="button"
                          data-nav-section="work">
                       검색
                  </button>
                </span>
              </div>
              <!-- /input-group -->
            </div>
            
          </div> <!-- .nearest-header-nav end -->
        </div>
        
      </div> <!-- container end -->
  </header>

  <div id="nearest-client-wrap" style="width: 1024px; margin: 0 auto;">

	  <div class="nearest-manage-list-wrap">
	               
	     <div class="nearest-manage-list">
	       <ul class="nav nav-tabs nav-justified" id="nearest-client-menu">
	         <li class="active"><a href="#">찜목록</a></li>
	         <li><a href="#">구매목록</a></li>
	         <li><a href="#">건의사항</a></li>
	       </ul>
	     </div>
	   </div>
	   <br/>
	   <br/>
	<div class="container">
	<div id="listPage">
	    <h1>내 게시물 목록</h1>
	    <br/>
	    <p><a href="add.do" class="btn btn-primary btn-sm">건의사항 등록</a></p>
	    <br/>
	    <table id="boardTbl" class="table table-hover">
	        <thead>
	        <tr>
	            <th>번호</th>
	            <th>내용</th>
	            <th>생성일</th>
	            <th>답변상황</th>
	        </tr>
	        </thead>
	        <tbody>
	        
	        </tbody>
	    </table>
	</div>
	<br/>
	<br/>
	<div id="formPage">
	<h2>건의사항 - 상세정보</h2>
	<br/>
	<br/>
	<form class="form-horizontal">
	  <div class="form-group bit-view-form bit-hidden">
	    <label class="col-sm-2 control-label">번호</label>
	    <div class="col-sm-10">
	      <p id="fNo" class="form-control-static"></p>
	    </div>
	  </div>
	  
	  <div class="form-group">
	    <label for="fContent" class="col-sm-2 control-label">내용</label>
	    <div class="col-sm-8">
	      <textarea id="fContent" class="form-control" rows="4" 
	                placeholder="내용을 입력하세요."></textarea>
	    </div>
	  </div>
	  
	  <div class="form-group bit-view-form bit-hidden">
	    <label class="col-sm-2 control-label">등록일</label>
	    <div class="col-sm-10">
	      <p id="fCreatedDate" class="form-control-static"></p>
	    </div>
	  </div>
	  
	  <div class="form-group">
	    <div class="col-sm-offset-2 col-sm-10">
	        <button id="addBtn" type="button" class="bit-new-form btn btn-primary btn-sm">등록</button>
	        <button id="updBtn" type="button" class="bit-view-form bit-hidden btn btn-primary btn-sm">변경</button>
	        <button id="delBtn" type="button" class="bit-view-form bit-hidden btn btn-primary btn-sm">삭제</button>
	        <button id="resetBtn" type="reset" class="btn btn-warning btn-sm">취소</button>
	    </div>
	  </div>
	  
	</form>    
	</div> <!-- #formPage -->
	
	<div id="footer"></div>
	
	</div> <!-- .container -->
	
	
	
  </div>
  
	<script id="tr-template" type="text/x-handlebars-template">
     {{#each data}}
    <tr>
        <td>{{no}}</td>
        <td><a href='#' data-no='{{no}}' class='titleLink'>{{title}}</a></td>
        <td>{{createdDate}}</td>
        <td>{{viewCount}}</td>
    </tr>
    {{/each}}
	</script>
	
	<!-- Main JS (Do not remove) -->
	<script src="./resources/js/app-context.js"></script>
	<script src="./resources/js/main.js"></script>
	<script src="./resources/js/main_dropdown.js"></script>
	<script src="./resources/js/main_search.js"></script>
	<script src="./resources/js/main_handlebars.js"></script>
	<script src="./resources/js/main_login.js"></script>
	<script src="./resources/js/main_register.js"></script>
	<script src="./resources/js/client_payment.js"></script>
	<script type="text/javascript">
	

	</script>
<script>
var source = $('#tr-template').text();
var template = Handlebars.compile(source);

loadBoards();

$('#footer').load("../copyright.html");

function loadBoards() {
    $('#boardTbl > tbody > tr').remove();
    $.ajax({
        url: contextRoot + 'board/list.json',
        dataType: 'json',
        method: 'get',
        success: function(result) {
            if(result.status != 'success'){
                  alert('실행 중 오류 발생!');
                  return;
            }
            $('#resetBtn').click();
            $('#boardTbl > tbody').append(template(result));
            
        },
        error: function(){
            alert('서버 요청 오류!');
        }
        
    });
}
$('#addBtn').click(function() {
    
    $.ajax({
        url: contextRoot + 'board/add.json',
        method: 'post',
        data: {
            title:$('#fTitle').val(),
            content:$('#fContent').val()
        },
        dataType: 'json',
        success: function(result) {
            if (result.status != 'success'){
                alert('등록 오류입니다.');
                return;
            }
            
            $('');
            loadBoards(); // 테이블 데이터를 갱신한다.
        },
        error: function() {
            alert('서버 요청 오류!');
        }
    });
});


$('#boardTbl').on('click', '.titleLink', function(event) {
    event.preventDefault(); // a 태그를 클릭할 때 서버에 요청하는 기본행위를 취소한다.
    //alert($(this).attr('data-no'));
    
    $.getJSON(contextRoot + 'board/detail.json?no=' + $(this).attr('data-no'), 
            function(result) {
               if(result.status != 'success') {
                   alert('게시물 조회 오류');
                   return;
               }
               
               $('.bit-view-form').removeclass('bit-hidden');
               $('.bit-new-form').addClass('bit-hidden');
               
               $('#fNo').text(result.data.no);
               $('#fTitle').val(result.data.title);
               $('#fContent').val(result.data.content);
               $('#fCreatedDate').text(result.data.createdDate);
               $('#fViewCount').text(result.data.viewCount);
    });
});

$('#resetBtn').click(function() {
    $('#fNo').text("");
    $('#fCreatedDate').text("");
    $('#fViewCount').text("");
    
    $('.bit-view-form').addClass('bit-hidden');
    $('.bit-new-form').removeClass('bit-hidden');
});

$('#delBtn').click(function(event) {
  $.getJSON(
          contextRoot + 'board/delete.json?no=' + $('#fNo').text(), 
      function(result) {
           if(result.status != 'success') {
             alert('게시물 삭제 오류');
             return;
           }
           
           $('.bit-view-form').addclass('bit-hidden');
           $('.bit-new-form').removeClass('bit-hidden');
           
           $('#resetBtn').click();
           
           loadBoards();
  });
});

$('#updBtn').click(function() {
      $.post(contextRoot + 'board/update.json', {
            no: $('#fNo').text(),
          title:$('#fTitle').val(),
          content:$('#fContent').val()
        }, function(result) {
          if (result.status != 'success'){
            alert('변경 오류입니다.');
            return;
          }
          
          $('.bit-view-form').addclass('bit-hidden');
        $('.bit-new-form').removeClass('bit-hidden');
        $('#resetBtn').click();
          
        alert('변경성공!');
          loadBoards(); // 테이블 데이터를 갱신한다.
        }, 'json');
});
</script>

</body>
</html>

